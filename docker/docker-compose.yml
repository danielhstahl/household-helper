services:
  app:
    image: ghcr.io/danielhstahl/householdhelper-draid:v0.1.2
    container_name: app
    environment:
      INIT_ADMIN_PASSWORD: [yourpassword]
      OPEN_AI_COMPATABLE_ENDPOINT: http://[yourllmip]:8100/ai/llm
      JWT_SECRET: [yourjwtsecret]
      ROCKET_DATABASES: '{draid={url="postgresql://[yourpsqluser]:[yourpsqlpassword]@psqldb:5432/draid"}}'
      ROCKET_PORT: 8000
      ROCKET_ADDRESS: 0.0.0.0
  kb:
    image: ghcr.io/danielhstahl/householdhelper-kb:v0.1.2
    container_name: kb
    environment:
      OLLAMA_ENDPOINT: http://[yourllmip]:8100/ai/embedding
      ROCKET_DATABASES: '{draid={url="postgresql://[yourpsqluser]:[yourpsqlpassword]@psqldb:5432/kb"}}'
      ROCKET_PORT: 8000
      ROCKET_ADDRESS: 0.0.0.0
      KNOWLEDGE_BASE_NAMES: '["recipes","gardening"]'

  ui:
    image: ghcr.io/danielhstahl/householdhelper-ui:v0.1.2
    environment:
      BACKEND_SERVICE: app:8000
    # for exposing outside the container network
    ports:
      - "8002:8000"

  psqldb:
    image: pgvector/pgvector:0.8.0-pg17-trixie
    container_name: psqldb
    environment:
      POSTGRES_PASSWORD: [yourpsqlpassword]
      POSTGRES_USER: [yourpsqluser]
    volumes:
      - "/volume1/docker/postgres:/var/lib/postgresql/data/"

volumes:
  psqldb:
